#:kivy 1.8.0
DarkBunnyGame:

<DarkBunnyGame>:
	gameworld: gameworld
	pos: root.pos
	size: root.size
	canvas:
		Color:
			rgb: (1., 1., 1.)
		Rectangle:
			size: self.size
			pos: self.pos
	GameWorld:
		id: gameworld
		gamescreenmanager: gamescreenmanager
		hawk_ai_system: hawk_ai_system
		boundary_system: boundary_system
		environment_system: environment_system
		music_controller: music_controller
		GameView:
			focus_entity: False
			updateable: False
			gameworld: root.gameworld
			pos: root.pos
			size: root.size
		GameMap:
			system_id: 'map'
			map_size: root.size
			gameworld: root.gameworld
		MusicController:
			volume: app.music_level
            id: music_controller
		CymunkPhysics:
			gameworld: root.gameworld
			damping: .9
		PhysicsRenderer:
			gameworld: root.gameworld
			system_id: 'shadow_renderer'
		PhysicsRenderer:
			gameworld: root.gameworld
			system_id: 'physics_renderer2'
		PhysicsRenderer:
			gameworld: root.gameworld
	    BoundarySystem:
	        id: boundary_system
	        system_id: 'boundary_system'
	        gameworld: root.gameworld
	        size: root.size
		PhysicsRenderer:
			gameworld: root.gameworld
			system_id: 'tree_physics_renderer'
		PhysicsRenderer:
	        gameworld: root.gameworld
	        system_id: 'hawk_physics_renderer'
	    HawkAISystem:
	        id: hawk_ai_system
			system_id: 'hawk_ai_system'
			gameworld: root.gameworld
			update_time: 1./30.
		RabbitSystem:
			gameworld: root.gameworld
			updateable: True
			update_time: 1./30.
		EnvironmentSystem:
		    id: environment_system
		    gameworld: root.gameworld
		AnimationSystem:
			gameworld: root.gameworld
			updateable: True
		LevelsSystem:
		    gameworld: root.gameworld
	    SoundSystem:
	    	volume: app.sound_level
	        system_id: 'sound_system'
	        gameworld: root.gameworld
		GameScreenManager:
			id: gamescreenmanager
			size: root.size
			pos: root.pos
			gameworld: root.gameworld


<GameScreenManager>:
	MainScreen:
		id: main_screen
	MainMenuScreen:
		id: menu_screen
	
<MainScreen@GameScreen>:
	name: 'main'
	FloatLayout:
		BoxLayout:
			size_hint: (.2, .1)
			pos_hint: {'x': .4, 'y': .1}
			orientation: 'vertical'
			DebugPanel:

<MainMenuScreen@GameScreen>:
	name: 'menu'
	FloatLayout:
		size: root.size
		pos: root.pos
		MainMenu:

<-CamouflopButton@Button>:
	font_name: 'assets/ui_elements/TEMPSITC.TTF'
	font_size: self.size[1]*.5
	canvas:
		Color:
			rgba: (1., 1. ,1., 1.) if root.state == 'normal' else (0., 0., 0., 1.)
		Rectangle:
			size: root.size
			pos: root.pos
		Color:
			rgba: (0., 0., 0., 1.) if root.state == 'normal' else (1., 1., 1., 1.)
		Line:
			rectangle: (self.pos[0], self.pos[1], self.size[0], self.size[1])
			width: 2.0

	Label:
		text: root.text
		font_size: root.font_size
		font_name: root.font_name
		color: (0., 0., 0., 1.) if root.state == 'normal' else (1., 1., 1., 1.)
		size: root.size
		pos: root.pos


<MainMenu@Widget>:
	title_image: title_image
	BoxLayout:
		size: root.size
		pos: root.pos
		orientation: 'vertical'
		Image:
			id: title_image
			source: 'assets/ui_elements/CamouflopLogo.png'
		BoxLayout:
			orientation: 'vertical'
			Widget:
				size_hint: (1., .05)
			BoxLayout:
				size_hint: (1., .25)
				padding: 10
				spacing: 10
				CamouflopButton:
					text: 'Play Game'
					on_press: app.root.start_game()
				CamouflopButton:
					text: 'Settings'
				CamouflopButton:
					text: 'Credits'
			Widget:
				size_hint: (1., .7)



<DebugPanel>:
    Label:
        pos: root.pos
        size: root.size
        halign: 'center'
        valign: 'middle'
        color: (0., 0., 0., 1.)
        text: 'FPS: ' + root.fps if root.fps != None else 'FPS:'